# Week 4 {#ch:Workshop4}

## Preliminary infomation {#sec:Prelim4}

Rates of change are important, whether it is the steepness of a hill (the rate of change of elevation with horizontal distance travelled), speed (rate of change of distance with time) or the rate of reaction (change in concentration of a reactant with respect to time). Differentiation is a mathematical method for determining the rate of change of one variable with another. 

Some functions are 'linear' (figure \@ref(fig:linear)), and the rate of change of the function is the gradient, $\frac{\Delta y}{\Delta x}$. So if we look at figure \@ref(fig:linear) the change of distance ($\Delta y$) with respect to time ($\Delta x$) is just the gradient, but not all functions are linear, and so not all gradients are constant, therefore not all rates of change are constant.

```{r echo=FALSE, linear, out.width='50%', fig.show='hold', fig.align='center', fig.cap='A linear plot with time on the x-axis and distance on the y axis, the gradient of the line is the velocity, the rate of change of distance with respect to time.'}
knitr::include_graphics("images/linearplot.png")
```

Many chemical reactions show a curved decay of concentration of reactant with time (figure \@ref(fig:expplot)). In this case the gradient of the line depends on where you measure it.

```{r echo=FALSE, expplot, out.width='50%', fig.show='hold', fig.align='center', fig.cap='An exponential decay plot with time on the x-axis and concentration of a reactant A on the y axis, the gradient is the rate of reaction and the rate of reaction varies with how far the reaction has proceeded.'}
knitr::include_graphics("images/expplot.png")
```

Differentiation is a mathematical way of determining what this gradient is at any given point.

### What is differentiation {#subsec:whatisdiff}

If we look at figure \@ref(fig:linear) the line fits the equation $y = mx+c$. The gradient of that line, $m$, is given by the change in y divided by the change in x:

\begin{equation*}
m = \frac{\Delta y}{\Delta x} = \frac{y_2-y_1}{x_2-x_1}
\end{equation*}

For each of the two points used to determine the gradient we may write an equation defining that point:

\begin{equation*}
y_1 = mx_1 + c\\
y_2 = mx_2 + c
\end{equation*}

and $x_2 = x_1+\Delta x$

and so we can express $y_2$ as:

\begin{equation*}
y_2 = m(x_1+ \Delta x) + c
\end{equation*}

The gradient of this line is:

\begin{equation*}
 \frac{\Delta y}{\Delta x} = \frac{y_2-y_1}{x_2-x_1}=\frac{(m(x_1+ \Delta x) + c) - (mx_1 + c)}{\Delta x} = m\frac{\Delta x}{\Delta x}=m
\end{equation*}

This is the least surprising result (and a relatively large amount of work) that you will likely see, but this principle can be used to show *what* differentiation is.

We can now show this same idea for a more complicated function, for example a quadratic.

### Showing why the differential of a quadratic is a linear function of x

```{r echo=FALSE, quad, out.width='80%', fig.show='hold', fig.align='center', fig.cap='Left: a harmonic oscillator model showing quadratic behaviour. Right: a zoomed in section of this model, showing different values of the gradient for different values of Δx, the smaller the value of Δx the better approximation to the gradient.'}
knitr::include_graphics("images/quadratic.png")
```

Figure \@ref(fig:quad) shows a harmonic oscilator which is a quadratic function of the form $y=ax^2+bx+c$. The image shows that the gradient of the point at the bottom of the curve may be approximated by different gradient triangles, the smaller the triangle the better the approximation to the curve, and therefore the better the approximation of the gradient at that point. As these triangles get smaller they better approach the gradient of the tangent to the line.

We can determine the gradient of of any point $(x_0, y_0)$, by using a second point $(x_1, y_1)$ as we did in section \@ref(subsec:whatisdiff). 

If a quadratic has the general form $y=ax^2+bx+c$, then we can write the equations for the points $(x_0, y_0)$ and $(x_1, y_1)$.

\begin{equation*}
y_0 = ax_0^2+bx_0+c\\
y_1 = ax_1^2+bx_1+c
\end{equation*}

and we know that $x_1=x_0+\Delta x$, so we can rewrite the equation for $y_1$:

\begin{equation*}
y_0 = ax_0^2+bx_0+c\\
y_1 = a(x_0+\Delta x)^2+b(x_0+\Delta x)+c
\end{equation*}

However as this gradient triangle reduces in size we can use a lower case delta ($\delta$) to indicate just a very small change in the x & y values.

\begin{equation*}
y_0 = ax_0^2+bx_0+c\\
y_1 = a(x_0+\delta x)^2+b(x_0+\delta x)+c
\end{equation*}

The gradient of this line is given by:

\begin{equation*}
\frac{\delta y}{\delta x} = \frac{y_1-y_0}{x_1-x_0} = \frac{(a(x_0+\delta x)^2+b(x_0+\delta x)+c)-(ax_0^2+bx_0+c)}{\delta x}
\end{equation*}

Simplifying:

\begin{equation*}
\frac{\delta y}{\delta x} = \frac{2ax_0 \delta x +2a \delta x^2+b\delta x}{\delta x}
\end{equation*}

With cancelling:

\begin{equation*}
\frac{\delta y}{\delta x} = 2ax_0+2a \delta x+b
\end{equation*}


As the size of the gradient triangle reduces (or more formally as $\delta x \rightarrow 0$) then the term with the remaining $\delta x$ tends to zero. When we do this we use the terminology $\frac{\textrm{d}y}{\textrm{d}x}$ to denote that we have reduced the size of this step to zero (an entirely mathematical concept). The formal notation of this is: $\frac{\textrm{d}y}{\textrm{d}x}=\lim\limits_{x \to 0}\frac{\delta y}{\delta x}$, our differential $\frac{\textrm{d}y}{\textrm{d}x}$ is what we get when we reduce the size of our step between our two values used to determine the gradient to zero.

So:
\begin{equation*}
\frac{\textrm{d}}{\textrm{d}x} ax^2+bx+c = 2ax+b
\end{equation*}

This is differentiation, and instead of going through this process with every possible function we can learn the rules of differentiation so that we can quickly get to the result of most functions that we can think of.

### Notation of differentiation

There are a couple of different ways of noting differentials, I tend to use a mixture of two methods. There are two different methods of reporting functions firstly where $y$ is a function of $x$ (*e.g.* $y = ax^2+bx+c$) where the differential notation $\frac{\textrm{d}y}{\textrm{d}x}$ tends to be used, secondly where we have a function of $x$ (*e.g.* $f(x) = ax^2+bx+c$) where the differential notation $f'(x)$ tends to be used.

We can also differentiate functions more than once, if we differentiate a function twice with respect to $x$ we can use either the notation $\frac{\textrm{d}^2y}{\textrm{d}x^2}$ or $f''(x)$.

The reasons why we may wish to differentiate a function twice are explained in section \@ref(subsec:turningpoints)

### Differentiating constants {#subsec:diffconst}

Graphically we can imagine a constant as a horizontal line on a graph, no matter the value of x, a constant is just that a constant, and therefore it should come as no surprise that the differential of a constant, $c$ is 0. Formally:

:::thing
\begin{equation}
y = c\\
\frac{\textrm{d}y}{\textrm{d}x}=0
(\#eq:diffconst)
\end{equation}
::: 

Recall that anything raised to the power 0 is one, so if we differentiate anything raised to the power zero we get 0.

### Differentiating polynomials {#subsec:diffpolynomial}

When differentiating polynomials the rule is always the same for all numerical powers except $x^0$ (a constant). In this case we multiply our variable by the old power, and deduct one from the starting power. So, if $a$ and $b$ are constants:

:::thing
\begin{equation}
y = ax^b\\
\frac{\textrm{d}y}{\textrm{d}x}=abx^{b-1}\\
\textrm{when } x \neq 0
(\#eq:diffpoly)
\end{equation}
::: 

This is true for positive intergers:

$y = 3x^3$     $\frac{\textrm{d}y}{\textrm{d}x} = 9x^2$

Negative integers (recall that negative powers are a way of expressing 1 over positive powers):
$y = ax^{-3}$     $\frac{\textrm{d}y}{\textrm{d}x} = -3ax^{-4}$

and fractions:
$y = 2x^{\frac{1}{2}}$     $\frac{\textrm{d}y}{\textrm{d}x} = x^{-\frac{1}{2}}$

Note in each case we have reduced the power by one, and multiplied the whole term by the old power.

### Differentiating exponentials {#subsec:diffexp}

:::thing
\begin{equation}
y = be^{ax}\\
\frac{\textrm{d}y}{\textrm{d}x}=abe^{ax}
(\#eq:diffexp)
\end{equation}
::: 

Exponential functions may be expressed as a polynomial series (Section \@ref(subsec:macexp)), this explains the result, but as chemists only the result of the differentiation is usually important.

For example if $y=e^{-2x}$, then:

\begin{equation*}
\frac{\textrm{d}y}{\textrm{d}x}=-2e^{-2x}\\
\textrm{and:}\\
\frac{\textrm{d}^2y}{\textrm{d}x^2}=4e^{-2x}
\end{equation*}

*Note how the power in an exponential function does not change.*

### Differentiating natural logs ($\ln$) {#subsec:difflogs}

We cannot directly differentiate any logs other than natural logs ($\ln$). We can use one of our rules of logs (equation \@ref(eq:convpower)) to convert the log to any other base to a natural log. However, natural logs describe behaviours found naturally in nature, such as chemical reactions and so it is rare to have to differentiate any other logs.

:::thing
\begin{equation}
y = \ln {ax}\\
\frac{\textrm{d}y}{\textrm{d}x}=\frac{1}{x}
(\#eq:diffln)
\end{equation}
:::

It may at first seem surprising that the constant $a$ in equation \@ref(eq:diffln) disappears in the differential, however, if we think about our rules of logs (equation \@ref(eq:logadd)), then $y=\ln {ax}$ may be rewritten as $y = \ln a +\ln x$ and of course $\ln a$ is a constant and so differentiates to 0 as shown in \@ref(eq:diffconst).

### Differentiating trig functions  {#subsec:difftrig}

If we look at how how the trig functions  $\sin$ and $\cos$ vary (figure \@ref(fig:trigcyclic)), we can see that when $\sin x$ has a maximum value (at $\frac{\pi}{2}$) the gradient at that point is 0. We can also see that the value of $\cos x$ at $\frac{\pi}{2}$ is also 0, this isn't coincidence, the functions $\sin$ and $\cos$ are intrinsically linked.

```{r echo=FALSE, trigcyclic, out.width='80%', fig.show='hold', fig.align='center', fig.cap='A plot of sin (x) (solid line) and cos (x) (dashed line) showing the repeating nature of the functions over 2π. We can note that when sin (x) reaches a maximum at π/2 and a minimum at 3π/2 (and the gradient is zero) then cos (x) is 0.'}
knitr::include_graphics("images/trigcyclic.png")
```

In fact if we differentiate $\sin x$ with respect to $x$ we get $\cos x$. You can see this if you look at the Maclaurin expansion for $\sin$ (equation \@ref(eq:macsin)) and $\cos$ (equation \@ref(eq:maccos)).


:::info
```{r echo=FALSE, difftrig, out.width='60%', fig.show='hold', fig.align='center', fig.cap='The cycle of differentiation which links sin (x) and cos (x). sin (x) differentiates to cos (x), cos (x) differentiates to -sin (x), -sin (x) differentiates to -cos (x) and -cos (x) differentiates to sin x.'}
knitr::include_graphics("images/difftrigcycle.png")
```
\begin{equation}
\begin{array}{ccc}
  f(x) \equiv y & & f^{\prime}(x) \equiv \dfrac{\textrm{d}y}{\textrm{d}x}\\
  \hline
\sin Ax & &A\cos Ax \\
\cos Ax & &-A\sin Ax \\
-\sin Ax & &-A\cos Ax \\
-\cos Ax & &A\sin Ax \\
\\
\end{array}
\end{equation}

The differential of $\tan x$ is not shown, it is shown later in section \@ref(subsec:productrule), but it is a result that is rarely needed in chemistry.
:::

### Determining turning points {#subsec:turningpoints}

As we have seen previously (in sections \@ref(subsec:diffpolynomial) and \@ref(subsec:difftrig)) we have taken note of points where the gradient (of differential) of a function is zero. These points are referred to as *turning points*; there are three types of turning point, maxima, minima, and points of inflection (figure \@ref(fig:turningpoints)). A turning point occurs when $\frac{\textrm{d}y}{\textrm{d}x}$.

```{r echo=FALSE, turningpoints, out.width='60%', fig.show='hold', fig.align='center', fig.cap='The different types of turning point, from left: minima - a negative gradient which changes into a postive gradient, maxima - a postive gradient which changes into a negative gradient, and points of inflection which may either be postive gradients leveling to a zero gradient and increasing again, or negative gradients leveling to zero and decreasing again.'}
knitr::include_graphics("images/turningpoints.png")
```

We can tell the nature of a turning point by one of two methods, first by inspection, and secondly using calculus and the second derivative of the function.

#### Determining turning points by inspection

The inspection method involves determining the coordinates of each turning point by differentiating the function. Then using the equation for the gradient of the line to include values just to the left and right of the turning point and determining if the gradient at that point is postive or negative.

For example, if we take the quadratic equation $y=4x^2+3x-7$, and determine the differential of this function:

\begin{equation*}
\frac{\textrm{d}y}{\textrm{d}x} = 4x+3
\end{equation*}

At the turning point $\dfrac{\textrm{d}y}{\textrm{d}x}=0$ and so at the turning point $x=-\frac{3}{4}$. Now we can examine what value the gradient has if we choose, for example, values of $x=-1$ and $x=-\frac{1}{2}$.

At $x=-1$, $\frac{\textrm{d}y}{\textrm{d}x} = (4 \times -1)+3 = -1$, which is negative.

At $x=-\frac{1}{2}$, $\frac{\textrm{d}y}{\textrm{d}x} = (4 \times -\frac{1}{2})+3 = 1$, which is postive.

Therefore, a negative gradient which changes into a postive gradient with increasing value of x implies that this point is a *minimum*. 

:::warning
It is adviseable to ensure points are close to the turning point of interest as some functions have more than one turning point.*
:::

#### Determining turning points by differentiation

Our second method for determining the nature of a turning point is by determining the second derivative of the original function, $\frac{\textrm{d}^2y}{\textrm{d}x^2}$. This second derivative is telling us the rate of change of the gradient.

:::thing
If the second derivative is:
\begin{equation*}
\begin{array}{ccc}
  f'(x) \equiv \tfrac{\textrm{d}y}{\textrm{d}x} & & type of turning point\\
  \hline
\textrm{negative}  & & \textrm{maximum}\\
\textrm{positive} & & \textrm{minimum}\\
0 & & \textrm{point of inflection}\\
\end{array}
\end{equation*}

The nature of the point of inflection will have to be determined by the inspection method.
:::

If we differentiate our function for a second time, and again input the value of x at the turning point, then we can tell the nature of the turning point. 

If we use the same example as above:

$y=4x^2+3x-7$, and $\frac{\textrm{d}y}{\textrm{d}x} = 4x+3$, we can determine the second differential ($\frac{\textrm{d}^2y}{\textrm{d}x^2}$):

\begin{equation*}
\frac{\textrm{d}^2y}{\textrm{d}x^2} = 4
\end{equation*}

This second derivative is postive, and therefore we know that the turning point is a minimum.

### Differentiating functions with more than one term

## Examples

## Summary of concepts learnt
:::info
\begin{equation*}
\begin{array}{ccc}
  f(x) \equiv y & & f^{\prime}(x) \equiv \dfrac{\textrm{d}y}{\textrm{d}x}\\
  \hline
A & &0 \\
 Ax^n & &nAx^{n-1} \\
 \dfrac{A}{x^n} \equiv A x^{-n} & &-nA x^{-n-1} \\
e^{Ax} & &Ae^{Ax} \\
A \ln Bx & &\dfrac{A}{x} \\
\sin Ax & &A\cos Ax \\
\cos Ax & &-A\sin Ax \\
\tan Ax & &-A\sec^2 Ax \\
\\
Au + Bv & &A\dfrac{\textrm{d}u}{\textrm{d}x} + B\dfrac{\textrm{d}v}{\textrm{d}x} \\
\end{array}
\end{equation*}

<div style="height: 1px; background-color: #9FC2D3"></div>

Chain Rule:

\begin{equation*}
\dfrac{\textrm{d}y}{\textrm{d}x}=\dfrac{\textrm{d}y}{\textrm{d}u} \times \dfrac{\textrm{d}u}{\textrm{d}x}
\end{equation*}
:::

## Questions {#sec:Questions4}

### 'Simple' differentiation

1. Find $\dfrac{\textrm{d}y}{\textrm{d}x}$ of the following functions:

a. $y = 6x + 4$
a. $y = 5x^2+ 3x-7$
a. $y = x^{-\frac{1}{2}}+ 3x-4$
a. $6x^{\frac{2}{3}}-x+9$
    
2. Find $\dfrac{\textrm{d}y}{\textrm{d}x}$ of the following functions:

a. $y = 3x^2 + \cos x$
a. $y = 6 \ln 2x$
a. $y = \frac{2}{3}e^{\frac{3x}{2}}$
a. $y = -e^{-5x}-e^{5x}$


### Turning points

Find the turning points $(x,y)$ for the following functions:

1. $y = 2x^3 - 9x^2 + 12x$
1. $y = 12x^5 - 45x^4 + 40x^3$

### Chain rule

Find the turning points $(x,y)$ for the following functions:

1. $y = sin^2(x)$
1. $y = sin(e^{4x})$
1. $y = e^{(7x^2 + 2x)}$
1. $y = (x-1)^9$

### Applied questions

1. If two electric dipoles are aligned in an adjacent parallel manner such that they are separated by distance r, their potential energy of interaction, V, is given by:

\begin{equation*}
V = \frac{\mu_1 \mu_2}{4 \pi \varepsilon_0 r^3}
\end{equation*}

determine $\dfrac{\textrm{d}V}{\textrm{d}r}$

2. Light is scattered as it passes though solutions containing small particles with an intensity I, given by the following expression:

\begin{equation*}
I = I_0 \frac{\pi \alpha ^2}{\varepsilon _r^2 \lambda^4 r^2})(\sin \phi)^2
\end{equation*}


determine expressions for how the intensity varies with:

a. wavelength, λ
a. angle, ϕ
a. distance from scatterer, r

*formally these are partial derivatives and we will learn about them next week*

3. The radius of a spherical balloon is increasing at a rate of 0.2 m s^−1^. Find the rate of increase of (a) the volume and (b) the surface area of the balloon at the instant when the radius is 1.6 m.

## Answers {#sec:Answers4}


### 'Simple' differentiation

1. $\dfrac{\textrm{d}y}{\textrm{d}x}=$
a. 6
a. $10x+3$
a. $-\frac{1}{2}x{-\frac{3}{2}}+3$
a. $4x^{-\frac{1}{3}}-1$

2. $\dfrac{\textrm{d}y}{\textrm{d}x}=$
a. $6x-\sin x$
a. $\frac{6}{x}$
a. $e^{\frac{3x}{2}}$
a. $5e^{-5x}-5e^{5x}$


### Turning points

1. (1,5)max, (2,4)min
1. (0,0) POI(+/+), (1,7)max, (2, −16)min

### Chain rule

1. $\dfrac{\textrm{d}y}{\textrm{d}x}= 2 \sin x \cos x$
1. $\dfrac{\textrm{d}y}{\textrm{d}x}=4e^{4x}\cos (e^{4x})$
1. $\dfrac{\textrm{d}y}{\textrm{d}x}= (14x+2)e^{(7x^2 + 2x)}$
1. $\dfrac{\textrm{d}y}{\textrm{d}x}= 9 (x-1)^8$

### Applied questions

1. \begin{equation*}
V = \frac{-3 \mu_1 \mu_2}{4 \pi \varepsilon_0 r^4}
\end{equation*}

2. -
a. \begin{equation*}
\dfrac{\textrm{d}I}{\textrm{d}\lambda}= -4I_0 \frac{\pi \alpha ^2}{\varepsilon _r^2 \lambda^5 r^2}(\sin \phi)^2
\end{equation*}
a. \begin{equation*}
\dfrac{\textrm{d}I}{\textrm{d}\phi}= 2I_0 \frac{\pi \alpha ^2}{\varepsilon _r^2 \lambda^4 r^2}(\sin \phi)(\cos \phi)
\end{equation*}
a. \begin{equation*}
\dfrac{\textrm{d}I}{\textrm{d}r}= -2I_0 \frac{\pi \alpha ^2}{\varepsilon _r^2 \lambda^4 r^3}(\sin \phi)^2
\end{equation*}

3. $\dfrac{\textrm{d}V}{\textrm{d}t}= 0.8 \pi r^2$, $\dfrac{\textrm{d}SA}{\textrm{d}t}=1.6 \pi r$
